color-chart {
	display: block;
	height: clamp(0em, 20em, 100vh);
	contain: size;
	container-name: chart;
	container-type: size;
}

@property --chart-width {
	syntax: '<length-percentage>';
	initial-value: 100%;
	inherits: true;
}

@property --width {
	syntax: "<length>";
	initial-value: 0px;
	inherits: true;
}

@property --height {
	syntax: "<length>";
	initial-value: 0px;
	inherits: true;
}

@property --angle {
	syntax: "<angle>";
	initial-value: 0deg;
	inherits: true;
}

color-chart > color-scale {
	display: contents;
	--chart-width: 100cqw;
	--chart-height: 100cqh;
	--step-x: calc(var(--chart-width) / (var(--color-count) - 1));
	--extent-x: calc(var(--max-x) - var(--min-x));
	--extent-y: calc(var(--max-y) - var(--min-y));

	&::part(color-swatch) {
		--_point-size: var(--point-size, .6em);

		position: absolute;
		top:  calc((1 - (var(--y) - var(--min-y)) / (var(--max-y) - var(--min-y))) * 100cqh);
		left: calc( (var(--x) - var(--min-x)) / (var(--max-x) - var(--min-x)) * 100%);
		width: var(--_point-size);
		aspect-ratio: 1;
		border-radius: 50%;
		background: yellow;
		min-block-size: 0;
		translate: -50% -50%;
		transition: 300ms;
		transition-property: width, height;
	}

	&::part(color-swatch):hover {
		/* Cannot use CSS transforms here because that also affects the line */
		--_point-size: calc(var(--point-size, .6em) * 1.2);
	}

	&::part(color-swatch)::before {
		--delta-x: calc(var(--next-x) - var(--x));
		--delta-y: calc(var(--next-y) - var(--y));
		--delta-y-abs: max(var(--delta-y), -1 * var(--delta-y));
		--angle: atan2(var(--height), var(--width));
		--offset: .1em / sin(var(--angle));
		--width: calc(var(--delta-x) / var(--extent-x) * var(--chart-width));
		--height: calc(var(--delta-y-abs) / var(--extent-y) * var(--chart-height));

		content: "";
		position: absolute;
		left: 50%;
		top: 50%;
		width: var(--width);
		height: var(--height);
		background: linear-gradient(to bottom right, var(--color), var(--next-color));
		clip-path: polygon(calc(-1 * var(--offset)) 0, calc(var(--offset)) 0, calc(100% + var(--offset)) 100%, calc(100% - var(--offset)) 100%);
		z-index: 1;
	}

	&::part(info) {
		display: none;
		background: white;
		position: absolute;
	}

	&::part(swatch) {
		min-block-size: 0;
		padding: .2em;
	}
}