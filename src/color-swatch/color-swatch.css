:host {
	--_transparency-cell-size: var(--transparency-cell-size, .5em);
	--_transparency-background: var(--transparency-background, transparent);
	--_transparency-darkness: var(--transparency-darkness, 5%);
	--_transparency-grid: var(--transparency-grid,
		repeating-conic-gradient(transparent 0 25%, rgb(0 0 0 / var(--_transparency-darkness)) 0 50%)
		0 0 / calc(2 * var(--_transparency-cell-size)) calc(2 * var(--_transparency-cell-size))
		content-box border-box var(--_transparency-background)
	);

	position: relative;
	display: inline-flex;
	gap: .3em;
	width: min-content;
	margin: .3em;
}

:host([size="large"]) {
	flex-flow: column;
	inline-size: 11em;
	min-block-size: 6em;
}

:host(:not([size="large"])) {

}

#gamut {
	font-size: 80%;


	&:is(:host([size="large"]) *) {
		position: absolute;
		top: 0;
		right: 0;
		margin: .5rem;
	}

	&:not(:host([size="large"]) *):is(.static *) {
		align-self: baseline;
	}
}

#wrapper {
	display: flex;
	flex-flow: inherit;
	gap: inherit;

	&.static {
		&:is(:host([size="large"]) *) {
			background: white;
		}
	}

	&:not(:host([size="large"]) *) {
		align-items: baseline;
	}
}

[part="color-wrapper"] {
	display: flex;
	gap: .2em;
}

slot:not([name]) {
	white-space: nowrap;

	&::slotted(input) {
		display: flex;
		box-sizing: border-box;
		min-width: 10ch;
		font: inherit;
	}

	&:is(:host([size="large"]) *)::slotted(input) {
		width: 100%;
	}
}

slot[name=swatch]::slotted(*),
#swatch {
	flex: 1;
	display: flex;
	flex-flow: column;
	align-items: center;
	justify-content: center;
	padding: .5em;
	display: flex;
	flex-flow: column;
	flex: 1;
	background:
		linear-gradient(var(--color) 0 100%),
		var(--_transparency-grid);
	border-radius: .2rem;

	&:is(:host([size="large"]) *) {
		min-block-size: 3em;
	}

	&:not(:host([size="large"]) *) {
		display: flex;
		min-inline-size: 2em;
		font-size: 65%;
		flex: 1;
	}
}

slot[name=swatch-content] {
	/* See https://lea.verou.me/blog/2024/contrast-color/ */
	--l: clamp(0, (var(--l-threshold, 0.7) / l - 1) * infinity, 1);
	color: oklch(from var(--color) var(--l) 0 h);
}

:host([swatch="none"]) #swatch {
	display: none;
}